---
output: html_document
editor_options: 
  chunk_output_type: console
format:
  html:
    html-table-processing: none
    toc-depth: 3
---

# Concordances {.unnumbered}

This appendix lists concordances between prior catalogues of Tůma's works and TumW. For concordances of historic and modern inventories, see [Inventories](inventories.qmd).

```{r packages and functions}
#| include: false
library(tidyverse)
library(yaml)
library(gt)
source("script/utils.R")
options(readr.show_col_types = FALSE)

params <- read_yaml("data/config.yml")

print_concordance <- function(catalogue) {
  notes <-
    read_csv("data/catalogue_notes.csv") %>% 
    filter(catalogue == {{catalogue}}) %>% 
    select(number, notes)
  
  read_rds("data_generated/works.rds") %>% 
    left_join(
      read_csv("data/catalogue_overview.csv") %>% distinct(group, file),
      by = "group"
    ) %>% 
    unite(group:number, col = "id", sep = ".", na.rm = TRUE) %>%
    mutate(
      number = .data[[catalogue]],
      id = str_glue("[{id}](/groups/{file}.html#work-{id})")
    ) %>%
    separate_longer_delim(number, delim = ", ") %>% 
    select(number, id) %>% 
    mutate(number = str_remove(number, " \\(\\?\\)$")) %>% 
    bind_rows(notes) %>% 
    filter(!is.na(number)) %>%
    summarise(
      .by = number,
      id = str_flatten_comma(id, na.rm = TRUE),
      notes = str_flatten_comma(notes, na.rm = TRUE)
    ) %>%
    mutate(id = if_else(id == "", "–", id)) %>% 
    arrange(str_rank(number, numeric = TRUE)) %>% 
    gt() %>%
    cols_width(number ~ px(80), id ~ px(160)) %>%
    fmt_markdown(columns = id) %>% 
    cols_label(id = params$catalogue_prefix) %>% 
    sub_missing(columns = notes, missing_text = "") %>% 
    tab_options(
      column_labels.font.weight = "bold",
      table.align = "left",
      table_body.hlines.style = "none"
    )
}
```


## @Ball1900 (BalTh)

```{r BalTh}
#| echo: false
#| output: asis
print_concordance("BalTh")
```


## @Klinka1975 (KliCh)

```{r KliCh}
#| echo: false
#| output: asis
print_concordance("KliCh")
```


## @Peschek1956 (PesMa)

```{r PesMa}
#| echo: false
#| output: asis
print_concordance("PesMa")
```


## @Reichert1935 (ReiMa)

```{r ReiMa}
#| echo: false
#| output: asis
print_concordance("ReiMa")
```


## @Vogg1951 (VogIn)

```{r VogIn}
#| echo: false
#| output: asis
print_concordance("VogIn")
```
